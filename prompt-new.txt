First thing that you need to check my code is working fine or not. 
firstly understand my logic and my code which i implemented 
mostly my all code is working fine but having some issues so check my following requirements based on these requirements correct my code:
refer following db tables:
    1. sales_orders
    2. sales_order_products
    3. warehouse_allocations
    4. warehouse_stocks
    5. purchase_orders
    6. purchase_order_products
    7. temp_orders

refer following routes: 
    1. /create-order
    2. /store-order
    3. /sales-order
    4. /sales-order-view/{id} 
    5. some other routes related to my logic 

refer following files: 
    1. resources\views\salesOrder\create.blade.php
    2. resources\views\salesOrder\view.blade.php
    3. resources\views\readyToShip\view-detail.blade.php
    4. app\Http\Controllers\SalesOrderController.php 
    5. app\Models\* (all models)
    6. app\Services\WarehouseAllocationService.php
    7. app\Providers\AppServiceProvider.php


When i try to create a new sales order then following things happens: 

## First step i fill form to check stock availibility for customers skus located: http://127.0.0.1:8000/create-order
1. check stock availibility for customer skus (http://127.0.0.1:8000/create-order) popup form on clicking check availibility button 
2. then after selecting customer group and warehouse(all/specific) and uploading excel file it will show list of products with their availability in the warehouse and also checks if customer and product is available in db or not.  
3. then i download that file and make necessary changes(block quantity, automatically purchase order quantity(unavailable quantity), vendor code) 
4. upload that file to create sales order (http://127.0.0.1:8000/create-order) 

5. after uploading that file it will create sales order and redirect to sales order list page (http://127.0.0.1:8000/sales-order) 

Here my core business logic starts firstly in checking availability of products in warehouse:

1. check if file is uploaded or not if not then show error message and redirect back to create order page 
2. check if file is uploaded then check if file is empty or not if empty then show error message and redirect back to create order page 
3. check if file is uploaded and not empty then check if file is valid or not if not valid then show error message and redirect back to create order page 
4. check if file is uploaded, not empty and valid then check if file has any duplicate customer(facility name from excel file) and sku(from excel file) by iterating through file if has then show error message and redirect back to create order page 

5. Then iterate through file and apply following logic:
    i. map customer sku with product sku if not found then get product sku from excel file 
    ii. check if customer is available in db or not if not then store in 'not found table' if any of these records which are not found 
    iii. check if product is available in db or not if not then store in 'not found table' if any of these records which are not found 
    iv. check if vendor is available in db or not if not then store in 'not found table' if any of these records which are not found 
6. if all these step 5 cases passed then it will create sales order and store in temp order table using following logic:
    i. firstly check if warehouse is selected as all or specific 
    ii. if all then we need to search product in all warehouses and block quantity from those warehouses and store in temp order table and sales order products 
    iii. block quantity only from those warehouses from which we have allocated quantity
    iv. if specific then we need to search product in specific warehouse and block quantity from that warehouse and store in temp order table and sales order products  
7. when we allocating quantity to any sales order then we need to block that much quantity in warehouseStock and reduce available quantity from that warehouseStock









You are a professional Laravel 10+ developer. FOLLOW EVERY REQUIREMENT EXACTLY - this is your only instruction set.

## âš™ï¸ SYSTEM REQUIREMENTS (NON-NEGOTIABLE)

**Every method MUST have:**
- Try-catch block
- DB::beginTransaction() & commit()/rollBack() 
- Validator::make() for input validation
- activity()->performedOn()->causedBy(Auth::user())->log()
- redirect()->with('success'|'error', 'msg')
- Log::error() on exceptions

**Every Blade template MUST have:**
- extend('layouts.master')
- @csrf in forms
- @error directives
- Breadcrumb navigation
- Bootstrap 5 (ONLY)
- Error alert at top
- Empty states in tables

**Every database operation:**
- Tables: plural snake_case (customer_groups)
- ->paginate(15)
- ->with() for eager loading
- $casts = ['status' => 'boolean']
- scopeActive() & scopeInactive()

**Naming (MANDATORY):**
- Controllers: Plural+Controller (CustomerGroupController)
- Models: Singular PascalCase (Customer)
- Views: Plural folder (customers/)
- Routes: dot notation (customer.groups.index)

## ðŸ“ VALIDATION PATTERNS

```
Text: required|string|max:255
Email: required|email|max:255|unique:table,column
Phone: required|regex:/^[0-9]{10}$/
File: required|file|mimes:xlsx,xls,csv|max:5120
Date: required|date|before:today
Status: nullable|in:0,1
```

## ðŸ’» CONTROLLER TEMPLATE

```php
public function action(Request $request, $id = null) {
    $validator = Validator::make($request->all(), ['field' => 'required|string|max:255']);
    if ($validator->fails()) return redirect()->back()->withErrors($validator)->withInput();
    
    DB::beginTransaction();
    try {
        $model = Model::findOrFail($id);
        $model->update(['field' => $request->field]);
        DB::commit();
        activity()->performedOn($model)->causedBy(Auth::user())->log('Action');
        return redirect()->route('items.index')->with('success', 'Done');
    } catch (\Exception $e) {
        DB::rollBack();
        Log::error($e->getMessage());
        return redirect()->back()->with('error', 'Error: ' . $e->getMessage())->withInput();
    }
}
```

## ðŸ“„ BLADE FORM TEMPLATE

```blade
@extends('layouts.master')
@section('main-content')
<main class="main-wrapper">
    <div class="main-content">
        <div class="page-breadcrumb mb-3">
            <nav><ol class="breadcrumb"><li class="breadcrumb-item"><a href="{{ route('dashboard') }}"><i class="bx bx-home-alt"></i></a></li><li class="breadcrumb-item active">Page</li></ol></nav>
        </div>
        
        @if($errors->any())
            <div class="alert alert-danger"><ul class="mb-0">@foreach($errors->all() as $e)<li>{{ $e }}</li>@endforeach</ul></div>
        @endif
        
        <div class="card">
            <div class="card-body">
                <form action="{{ route('items.store') }}" method="POST">
                    @csrf
                    <div class="mb-3">
                        <label class="form-label">Field <span class="text-danger">*</span></label>
                        <input type="text" class="form-control @error('field') is-invalid @enderror" name="field" value="{{ old('field') }}" required>
                        @error('field')<div class="invalid-feedback">{{ $message }}</div>@enderror
                    </div>
                    <button type="submit" class="btn btn-primary">Save</button>
                </form>
            </div>
        </div>
    </div>
</main>
@endsection
```

## ðŸ“Š BLADE TABLE TEMPLATE

```blade
<table class="table table-striped table-hover">
    <thead class="table-light">
        <tr><th style="width:40px;"><input type="checkbox" id="selectAll"></th><th>Name</th><th>Status</th><th style="width:120px;">Actions</th></tr>
    </thead>
    <tbody>
        @forelse($items as $item)
            <tr>
                <td><input type="checkbox" class="item-checkbox" name="ids[]" value="{{ $item->id }}"></td>
                <td>{{ $item->name }}</td>
                <td><span class="badge {{ $item->status ? 'bg-success' : 'bg-secondary' }}">{{ $item->status ? 'Active' : 'Inactive' }}</span></td>
                <td><a href="{{ route('items.edit', $item->id) }}" class="btn btn-sm btn-info"><i class="bx bx-pencil"></i></a></td>
            </tr>
        @empty
            <tr><td colspan="4" class="text-center text-muted py-4">No records found</td></tr>
        @endforelse
    </tbody>
</table>
```

## ðŸ”„ AJAX STATUS TOGGLE

```php
public function toggleStatus(Request $request) {
    $validator = Validator::make($request->all(), ['id' => 'required|exists:table,id', 'status' => 'required|in:0,1']);
    if ($validator->fails()) return response()->json(['success' => false], 422);
    
    DB::beginTransaction();
    try {
        $item = Model::findOrFail($request->id);
        $item->status = $request->status;
        $item->save();
        DB::commit();
        activity()->performedOn($item)->causedBy(Auth::user())->log('Status changed');
        return response()->json(['success' => true]);
    } catch (\Exception $e) {
        DB::rollBack();
        return response()->json(['success' => false, 'message' => $e->getMessage()], 500);
    }
}
```

## âœ… IMPORTS

```php
use Illuminate\Http\Request;
use Illuminate\Support\Facades\{Auth, DB, Log, Validator};
use Spatie\SimpleExcel\SimpleExcelReader;
```

## âœ“ DO | âœ— DON'T

âœ“ Bootstrap 5 | âœ— Custom CSS
âœ“ @csrf token | âœ— Skip it
âœ“ Error handling | âœ— Forget it
âœ“ Validation | âœ— Skip it
âœ“ Transactions | âœ— No rollback
âœ“ Activity log | âœ— Skip it
âœ“ Breadcrumbs | âœ— Missing
âœ“ Eager load | âœ— N+1 queries
âœ“ withInput() | âœ— Lose data
âœ“ @error directives | âœ— No feedback












packaging, 
packaged, 
ready_to_ship, 
shipped, 
completed